import{getInstance}from"/index.js";export default class TrailImage{static get selector(){return".trail-image"}constructor(t){this.block=t,this.imagesWrapper=this.block.querySelector(".trail-image__wrapper"),this.image=this.block.querySelector(".trail-image__image"),this.block.rect=this.block.getBoundingClientRect(),this.trailsTotal=6;for(let t=0;t<=this.trailsTotal-1;++t){const i=document.createElement("div");i.className="trail-image__trail",i.dataset.index=t,i.style.backgroundImage=this.image.style.backgroundImage,this.imagesWrapper.insertBefore(i,this.imagesWrapper.firstChild)}this.trails=[...this.imagesWrapper.querySelectorAll(".trail-image__trail")],this.trails.reverse(),this.imagePosition={previous:{x:0,y:0},current:{x:0,y:0},amt:.09},this.trailsTranslation=[...new Array(this.trailsTotal)].map(()=>({previous:{x:0,y:0},current:{x:0,y:0},amt:t=>.09-.01*t})),this.onReady=this.onReady.bind(this),this.onMouseMove=this.onMouseMove.bind(this),this.render=this.render.bind(this),this.layout=this.layout.bind(this),this.onMouseLeave=this.onMouseLeave.bind(this)}onReady(){const t=document.querySelector(".smooth-scroll");this.smoothScroll=getInstance(t),this.block.addEventListener("mousemove",this.onMouseMove),this.block.addEventListener("mouseleave",this.onMouseLeave),this.render()}onMouseMove(t){this.block.classList.add("visible");const i=t.clientX-this.block.rect.left,s=this.smoothScroll&&this.smoothScroll.getTranslationY?t.clientY+this.smoothScroll.getTranslationY():t.clientY+window.scrollY;this.imagePosition.current.x=i,this.imagePosition.current.y=s;for(let t=0;t<=this.trailsTotal-1;++t)this.trailsTranslation[t].current.x=i,this.trailsTranslation[t].current.y=s}onMouseLeave(){this.block.classList.remove("visible")}render(){this.imagePosition.previous.x=this.imagePosition.previous.x+(this.imagePosition.current.x-this.imagePosition.previous.x)*this.imagePosition.amt,this.imagePosition.previous.y=this.imagePosition.previous.y+(this.imagePosition.current.y-this.imagePosition.previous.y)*this.imagePosition.amt;for(let t=0;t<=this.trailsTotal-1;++t)this.trailsTranslation[t].previous.x=this.trailsTranslation[t].previous.x+(this.trailsTranslation[t].current.x-this.trailsTranslation[t].previous.x)*this.trailsTranslation[t].amt(t),this.trailsTranslation[t].previous.y=this.trailsTranslation[t].previous.y+(this.trailsTranslation[t].current.y-this.trailsTranslation[t].previous.y)*this.trailsTranslation[t].amt(t);this.layout(),this.raf=window.requestAnimationFrame(this.render)}layout(){this.image.style.transform=`translate3d(calc(${this.imagePosition.previous.x}px - 50%), calc(${this.imagePosition.previous.y}px - 50%), 0)`;for(let t=0;t<=this.trailsTotal-1;++t)this.trails[t].style.transform=`translate3d(calc(${this.trailsTranslation[t].previous.x}px - 50%), calc(${this.trailsTranslation[t].previous.y}px - 50%), 0)`}}